<link rel="import" href="../polymer/polymer.html">

<!--
`br-signal-strength`
A simple UI element to indicate signal strength

@demo demo/index.html
-->

<dom-module id="br-signal-strength">
  <template>
    <style>
      :host {
        display: block;
      }

      :host .signal-strength {
      	position: relative;
      	display: inline-block;
      	width: 25px;
      	height: 15px;
      	/* background-color: white; */
      	margin-left: 1px;
      	margin-right: 1px;
      }

      :host .signal-bar {
      	position: absolute;
      	bottom: 0;
      	display: inline-block;
      	float: left;
      	width: 4px;
      	margin-left: 0px;
      	margin-right: 1px;
      	border: 0px solid black;
      	background-color: rgba(0,0,0,0.2);
      }

      :host .signal-bar-1 {
      	left: 0;
      	height: 3px;
      }

      :host .signal-bar-2 {
      	left: 5px;
      	height: 6px;
      }

      :host .signal-bar-3 {
      	left: 10px;
      	height: 9px;
      }

      :host .signal-bar-4 {
      	left: 15px;
      	height: 12px;
      }

      :host .signal-bar-5 {
      	left: 20px;
      	height: 15px;
      }

      :host .signal-bar-filled, .signal-bar[active] {
      	background-color: #0067c6;
      }
    </style>
    <div id="signalStrength" class="signal-strength">
      <span class="signal-bar signal-bar-1" active$="{{_checkBarActive(1,level)}}"></span>
      <span class="signal-bar signal-bar-2" active$="{{_checkBarActive(2,level)}}"></span>
      <span class="signal-bar signal-bar-3" active$="{{_checkBarActive(3,level)}}"></span>
      <span class="signal-bar signal-bar-4" active$="{{_checkBarActive(4,level)}}"></span>
      <span class="signal-bar signal-bar-5" active$="{{_checkBarActive(5,level)}}"></span>
    </div>
  </template>

  <script>
    Polymer({

      is: 'br-signal-strength',

      properties: {
        level: {
          type: Number,
          value: 0
        },
        levelOne: {
          type: Number,
          value: -87
        },
        levelTwo: {
          type: Number,
          value: -82
        },
        levelThree: {
          type: Number,
          value: -77
        },
        levelFour: {
          type: Number,
          value: -72
        },
        levelFive: {
          type: Number,
          value: -67
        },
        rssi: {
          type: Number
        }
      },

      observers: [
        '_observeRssi(rssi,levelOne,levelTwo,levelThree,levelFour,levelFive)'
      ],

      _checkBarActive: function(bar,level){
        return (level >= bar);
      },

      _observeRssi: function(rssi,l1,l2,l3,l4,l5){
        if(typeof rssi !== "number" || rssi === null) return;
        if(rssi < l1) this.set('level',0);
        else if(rssi < l2) this.set('level',1);
        else if(rssi < l3) this.set('level',2);
        else if(rssi < l4) this.set('level',3);
        else if(rssi < l5) this.set('level',4);
        else this.set('level',5)
      }

    });
  </script>
</dom-module>
